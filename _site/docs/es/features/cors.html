<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <title>Habilitando CORS (Compartici&#243;n de Recursos entre Or&#237;genes) en Sisk | Sisk </title>
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta name="title" content="Habilitando CORS (Compartici&#243;n de Recursos entre Or&#237;genes) en Sisk | Sisk ">


        <link rel="icon" href="../../../assets/img/favicon.ico">
        <link rel="stylesheet" href="../../../public/docfx.min.css">
        <link rel="stylesheet" href="../../../public/main.css">

        <link rel="preconnect" href="https://fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link href="https://fonts.googleapis.com/css2?family=Geist+Mono:wght@100..900&family=Geist:wght@100..900&display=swap" rel="stylesheet">

        <meta name="docfx:navrel" content="../../../toc.html">
        <meta name="docfx:tocrel" content="../toc.html">

        <meta name="docfx:rel" content="../../../">


        <meta name="docfx:docurl" content="https://github.com/sisk-http/docs/blob/master/docs/es/features/cors.md/#L1">
        <meta name="loc:inThisArticle" content="In this article">
        <meta name="loc:searchResultsCount" content="{count} results for &quot;{query}&quot;">
        <meta name="loc:searchNoResults" content="No results for &quot;{query}&quot;">
        <meta name="loc:tocFilter" content="Filter by title">
        <meta name="loc:nextArticle" content="Next">
        <meta name="loc:prevArticle" content="Previous">
        <meta name="loc:themeLight" content="Light">
        <meta name="loc:themeDark" content="Dark">
        <meta name="loc:themeAuto" content="Auto">
        <meta name="loc:changeTheme" content="Change theme">
        <meta name="loc:copy" content="Copy">
        <meta name="loc:downloadPdf" content="Download PDF">
        
        <script type="module" src="./../../../public/docfx.min.js"></script>
        <script>
            const theme = localStorage.getItem('theme') || 'auto';
            document.documentElement.setAttribute('data-bs-theme', theme === 'auto' ? (window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light') : theme)
        </script>
        
        <script src="https://unpkg.com/@cypherpotato/el/dist/el.min.js"></script>
        
        <!-- GoatCounter -->
        <script data-goatcounter="https://siskframework.goatcounter.com/count" async src="//gc.zgo.at/count.js"></script>
        <!-- End GoatCounter -->
        
        <script>            
            function switchLanguage(lang) {
                const docPart = window.location.pathname.match(/\/docs\/((pt\-br|ru|cn|es|de|jp)\/)?(.*)/)[3];
                const newPath = lang + docPart;
                window.location.href = window.location.origin + newPath;
            }        
        </script>
        
    </head>
    
    
    <body class="tex2jax_ignore" data-layout="" data-yaml-mime="">
        <header class="bg-body border-bottom">
            <nav id="autocollapse" class="navbar navbar-expand-md" role="navigation">
                <div class="container-xxl flex-nowrap">
                    <a class="navbar-brand" href="../../../index.html">
                        <img id="logo" class="svg" src="../../../assets/img/Icon.png" alt="Sisk">
                        Sisk
                    </a>
                    <button class="btn btn-lg d-md-none border-0" type="button" data-bs-toggle="collapse" data-bs-target="#navpanel" aria-controls="navpanel" aria-expanded="false" aria-label="Toggle navigation">
                        <i class="bi bi-three-dots"></i>
                    </button>
                    <div class="collapse navbar-collapse" id="navpanel">
                        <div id="navbar">
                            <form class="search" role="search" id="search">
                                <i class="bi bi-search"></i>
                                <input class="form-control" id="search-query" type="search" disabled placeholder="Search" autocomplete="off" aria-label="Search">
                            </form>
                        </div>
                    </div>
                </div>
            </nav>
        </header>

        <main class="container-xxl">
            <div class="toc-offcanvas">
                <div class="offcanvas-md offcanvas-start" tabindex="-1" id="tocOffcanvas" aria-labelledby="tocOffcanvasLabel">
                    <div class="offcanvas-header">
                        <h5 class="offcanvas-title" id="tocOffcanvasLabel">Table of Contents</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="offcanvas" data-bs-target="#tocOffcanvas" aria-label="Close"></button>
                    </div>
                    <div class="offcanvas-body">
                        <nav class="toc" id="toc"></nav>
                    </div>
                </div>
            </div>

            <div class="content">
                <div class="actionbar">
                    <button class="btn btn-lg border-0 d-md-none" style="margin-top: -.65em; margin-left: -.8em" type="button" data-bs-toggle="offcanvas" data-bs-target="#tocOffcanvas" aria-controls="tocOffcanvas" aria-expanded="false" aria-label="Show table of contents">
                        <i class="bi bi-list"></i>
                    </button>

                    <nav id="breadcrumb"></nav>

                    <div id="language-wrapper">
                        <a class="btn border-0 dropdown-toggle show" data-bs-toggle="dropdown" aria-expanded="true" title="Change theme">
                            <i class="bi bi-globe"></i>
                        </a>
                        <ul class="dropdown-menu dropdown-menu-end language-dropdown">
                            <li>
                                <a class="dropdown-item" href="javascript:switchLanguage('/docs/')">
                                    <img src="/assets/flag/usa.png">
                                    English
                                </a>
                            </li>
                            <li>
                                <a class="dropdown-item" href="javascript:switchLanguage('/docs/ru/')">
                                    <img src="/assets/flag/russia.png">
                                    Русский
                                </a>
                            </li>
                            <li>
                                <a class="dropdown-item" href="javascript:switchLanguage('/docs/pt-br/')">
                                    <img src="/assets/flag/brazil.png">
                                    Português
                                </a>
                            </li>
                            <li>
                                <a class="dropdown-item" href="javascript:switchLanguage('/docs/es/')">
                                    <img src="/assets/flag/spain.png">
                                    Español
                                </a>
                            </li>
                            <li>
                                <a class="dropdown-item" href="javascript:switchLanguage('/docs/de/')">
                                    <img src="/assets/flag/germany.png">
                                    Deutsch
                                </a>
                            </li>
                            <li>
                                <a class="dropdown-item" href="javascript:switchLanguage('/docs/cn/')">
                                    <img src="/assets/flag/china.png">
                                    中文 (简体)
                                </a>
                            </li>
                            <li>
                                <a class="dropdown-item" href="javascript:switchLanguage('/docs/jp/')">
                                    <img src="/assets/flag/japan.png">
                                    日本語
                                </a>
                            </li>
                        </ul>
                    </div>
                </div>

                <article data-uid="">
<h1 id="habilitando-cors-compartición-de-recursos-entre-orígenes-en-sisk">Habilitando CORS (Compartición de Recursos entre Orígenes) en Sisk</h1>

<p>Sisk tiene una herramienta que puede ser útil para manejar la <a href="https://developer.mozilla.org/en-US/docs/es/Web/HTTP/Guides/CORS">Compartición de Recursos entre Orígenes (CORS)</a> cuando expones tu servicio públicamente. Esta característica no forma parte del protocolo HTTP sino que es una característica específica de los navegadores web definida por el W3C. Este mecanismo de seguridad evita que una página web haga solicitudes a un dominio diferente al que proporcionó la página web. Un proveedor de servicio puede permitir que ciertos dominios accedan a sus recursos, o solo uno.</p>
<h2 id="misma-origen">Misma Origen</h2>
<p>Para que un recurso sea identificado como “misma origen”, una solicitud debe identificar la cabecera <a href="https://developer.mozilla.org/en-US/docs/es/Web/HTTP/Reference/Headers/Origin">Origin</a> en su solicitud:</p>
<pre><code class="lang-http">GET /api/users HTTP/1.1
Host: example.com
Origin: http://example.com
...
</code></pre>
<p>Y el servidor remoto debe responder con una cabecera <a href="https://developer.mozilla.org/en-US/docs/es/Web/HTTP/Headers/Access-Control-Allow-Origin">Access-Control-Allow-Origin</a> con el mismo valor que el origen solicitado:</p>
<pre><code class="lang-http">HTTP/1.1 200 OK
Access-Control-Allow-Origin: http://example.com
...
</code></pre>
<p>Esta verificación es <strong>explícita</strong>: el host, puerto y protocolo deben ser los mismos que los solicitados. Verifica el ejemplo:</p>
<ul>
<li>Un servidor responde que su <code>Access-Control-Allow-Origin</code> es <code>https://example.com</code>:
<ul>
<li><code>https://example.net</code> - el dominio es diferente.</li>
<li><code>http://example.com</code> - el esquema es diferente.</li>
<li><code>http://example.com:5555</code> - el puerto es diferente.</li>
<li><code>https://www.example.com</code> - el host es diferente.</li>
</ul>
</li>
</ul>
<p>En la especificación, solo se permite la sintaxis para ambas cabeceras, tanto para solicitudes como respuestas. La ruta URL se ignora. El puerto también se omite si es un puerto predeterminado (80 para HTTP y 443 para HTTPS).</p>
<pre><code class="lang-http">Origin: null
Origin: &lt;scheme&gt;://&lt;hostname&gt;
Origin: &lt;scheme&gt;://&lt;hostname&gt;:&lt;port&gt;
</code></pre>
<h2 id="habilitando-cors">Habilitando CORS</h2>
<p>Nativamente, tienes el objeto <a href="/api/Sisk.Core.Entity.CrossOriginResourceSharingHeaders">CrossOriginResourceSharingHeaders</a> dentro de tu <a href="/api/Sisk.Core.Http.ListeningHost">ListeningHost</a>.</p>
<p>Puedes configurar CORS al inicializar el servidor:</p>
<pre><code class="lang-csharp">static async Task Main(string[] args)
{
    using var app = HttpServer.CreateBuilder()
        .UseCors(new CrossOriginResourceSharingHeaders(
            allowOrigin: &quot;http://example.com&quot;,
            allowHeaders: [&quot;Authorization&quot;],
            exposeHeaders: [&quot;Content-Type&quot;]))
        .Build();

    await app.StartAsync();
}
</code></pre>
<p>El código anterior enviará las siguientes cabeceras para <strong>todas las respuestas</strong>:</p>
<pre><code class="lang-http">HTTP/1.1 200 OK
Access-Control-Allow-Origin: http://example.com
Access-Control-Allow-Headers: Authorization
Access-Control-Expose-Headers: Content-Type
</code></pre>
<p>Estas cabeceras deben enviarse para todas las respuestas a un cliente web, incluidos errores y redirecciones.</p>
<p>Puedes notar que la clase <a href="/api/Sisk.Core.Entity.CrossOriginResourceSharingHeaders">CrossOriginResourceSharingHeaders</a> tiene dos propiedades similares: <a href="/api/Sisk.Core.Entity.CrossOriginResourceSharingHeaders.AllowOrigin">AllowOrigin</a> y <a href="/api/Sisk.Core.Entity.CrossOriginResourceSharingHeaders.AllowOrigins">AllowOrigins</a>. Ten en cuenta que una es plural, mientras que la otra es singular.</p>
<ul>
<li>La propiedad <strong>AllowOrigin</strong> es estática: solo el origen que especifiques se enviará para todas las respuestas.</li>
<li>La propiedad <strong>AllowOrigins</strong> es dinámica: el servidor verifica si el origen de la solicitud está contenido en esta lista. Si se encuentra, se envía para la respuesta de ese origen.</li>
</ul>
<h3 id="caracteres-comodín-y-cabeceras-automáticas">Caracteres comodín y cabeceras automáticas</h3>
<p>Alternativamente, puedes usar un comodín (<code>*</code>) en el origen de la respuesta para indicar que cualquier origen está permitido acceder al recurso. Sin embargo, este valor no está permitido para solicitudes que tengan credenciales (cabeceras de autorización) y esta operación <a href="https://developer.mozilla.org/en-US/docs/es/Web/HTTP/Guides/CORS/Errors/CORSNotSupportingCredentials">resultará en un error</a>.</p>
<p>Puedes solucionar este problema enumerando explícitamente los orígenes que serán permitidos a través de la propiedad <a href="/api/Sisk.Core.Entity.CrossOriginResourceSharingHeaders.AllowOrigins">AllowOrigins</a> o también usar la constante <a href="/api/Sisk.Core.Entity.CrossOriginResourceSharingHeaders.AutoAllowOrigin">AutoAllowOrigin</a> en el valor de <a href="/api/Sisk.Core.Entity.CrossOriginResourceSharingHeaders.AllowOrigin">AllowOrigin</a>. Esta propiedad mágica definirá la cabecera <code>Access-Control-Allow-Origin</code> con el mismo valor que la cabecera <code>Origin</code> de la solicitud.</p>
<p>También puedes usar <a href="/api/Sisk.Core.Entity.CrossOriginResourceSharingHeaders.AutoFromRequestMethod">AutoFromRequestMethod</a> y <a href="/api/Sisk.Core.Entity.CrossOriginResourceSharingHeaders.AutoFromRequestHeaders">AutoFromRequestHeaders</a> para un comportamiento similar a <code>AllowOrigin</code>, que responde automáticamente según las cabeceras enviadas.</p>
<pre><code class="lang-csharp">using var host = HttpServer.CreateBuilder()
    .UseCors(new CrossOriginResourceSharingHeaders(
        
        // Responde según la cabecera Origin de la solicitud
        allowOrigin: CrossOriginResourceSharingHeaders.AutoAllowOrigin,
        
        // Responde según la cabecera Access-Control-Request-Method o el método de la solicitud
        allowMethods: [CrossOriginResourceSharingHeaders.AutoFromRequestMethod],

        // Responde según la cabecera Access-Control-Request-Headers o las cabeceras enviadas
        allowHeaders: [CrossOriginResourceSharingHeaders.AutoFromRequestHeaders]))
</code></pre>
<h2 id="otras-formas-de-aplicar-cors">Otras Formas de Aplicar CORS</h2>
<p>Si estás trabajando con <a href="/docs/es/extensions/service-providers">service providers</a>, puedes sobreescribir valores definidos en el archivo de configuración:</p>
<pre><code class="lang-csharp">static async Task Main(string[] args)
{
    using var app = HttpServer.CreateBuilder()
        .UsePortableConfiguration(...)
        .UseCors(cors =&gt; {
            // Sobrescribirá el origen definido en la configuración
            // archivo.
            cors.AllowOrigin = &quot;http://example.com&quot;;
        })
        .Build();

    await app.StartAsync();
}
</code></pre>
<h2 id="deshabilitando-cors-en-rutas-específicas">Deshabilitando CORS en Rutas Específicas</h2>
<p>La propiedad <code>UseCors</code> está disponible tanto para rutas como para todos los atributos de ruta y puede desactivarse con el siguiente ejemplo:</p>
<pre><code class="lang-csharp">[RoutePrefix(&quot;api/widgets&quot;)]
public class WidgetController : Controller {

    // GET /api/widgets/colors
    [RouteGet(&quot;/colors&quot;, UseCors = false)]
    public IEnumerable&lt;string&gt; GetWidgets() {
        return new[] { &quot;Green widget&quot;, &quot;Red widget&quot; };
    }
}
</code></pre>
<h2 id="reemplazando-valores-en-la-respuesta">Reemplazando Valores en la Respuesta</h2>
<p>Puedes reemplazar o eliminar valores explícitamente en una acción de enrutador:</p>
<pre><code class="lang-csharp">[RoutePrefix(&quot;api/widgets&quot;)]
public class WidgetController : Controller {

    public IEnumerable&lt;string&gt; GetWidgets(HttpRequest request) {

        // Elimina la cabecera Access-Control-Allow-Credentials
        request.Context.OverrideHeaders.AccessControlAllowCredentials = string.Empty;
        
        // Reemplaza el Access-Control-Allow-Origin
        request.Context.OverrideHeaders.AccessControlAllowOrigin = &quot;https://contorso.com&quot;;

        return new[] { &quot;Green widget&quot;, &quot;Red widget&quot; };
    }
}
</code></pre>
<h2 id="solicitudes-preflight">Solicitudes Preflight</h2>
<p>Una solicitud preflight es una solicitud de método <a href="https://developer.mozilla.org/en-US/docs/es/Web/HTTP/Reference/Methods/OPTIONS">OPTIONS</a> que el cliente envía antes de la solicitud real.</p>
<p>El servidor Sisk siempre responderá a la solicitud con un <code>200 OK</code> y las cabeceras CORS aplicables, y luego el cliente puede proceder con la solicitud real. Esta condición solo no se aplica cuando existe una ruta para la solicitud con el <a href="/api/Sisk.Core.Routing.RouteMethod">RouteMethod</a> configurado explícitamente para <code>Options</code>.</p>
<h2 id="deshabilitando-cors-globalmente">Deshabilitando CORS Globalmente</h2>
<p>No es posible hacer esto. Para no usar CORS, no lo configures.</p>

</article>

                <div class="contribution d-print-none">
                    <a href="https://github.com/sisk-http/docs/blob/master/docs/es/features/cors.md/#L1" class="edit-link">Edit this page</a>
                </div>

                <div class="next-article d-print-none border-top" id="nextArticle"></div>

            </div>

            <div class="affix">
                <nav id="affix"></nav>
            </div>
        </main>

        <div class="container-xxl search-results" id="search-results"></div>

        <footer class="border-top text-secondary">
            <div class="container-xxl">
                <div class="flex-fill">
                    <span>Made with <a href="https://dotnet.github.io/docfx">docfx</a></span>
                </div>
            </div>
            <script>
                if (window.location.pathname.startsWith('/docs/')) {
                    document.getElementById('language-wrapper').style.display = 'block';
                }
                
                function splitText(text, words) {
                    if (!Array.isArray(words)) return [];
                    const escapedWords = words.map(word =>
                        word.replace(/([.*+?^${}()|[\]\\])/g, '\\$1').replace(/\s/g, '\\$&'));
                        
                    escapedWords.sort((a, b) => b.length - a.length || b.localeCompare(a, 'en-US', { sensitivity: 'base' }));
                    const pattern = new RegExp(`\\b(${escapedWords.join('|')})\\b`, 'gi');
                    const splitResult = text.split(pattern);
                    const cleanedResult = splitResult.filter(segment => segment !== '');
                    return cleanedResult;
                }
                
                function runPostHljsFunctions() {
                    if (!document.querySelector("pre>code")) {
                        return;
                    }
                    if (!document.querySelector(".hljs")) {
                        setTimeout(runPostHljsFunctions, 100);
                        return;
                    }
                    
                    function highlightMissingCodeTokens(pre) {
                        const tokenClasses = [
                            "HttpResponse", "HttpRequest", "File", "Task",
                            "Router", "Route", "StringContent", "StreamContent",
                            "JsonContent", "RegexRoute", "HtmlContent", "CancellationTokenSource",
                            "HttpContext", "Stream", "MultipartObject", "Thread", "Task", "Encoding",
                            "HttpKnownHeaderNames", "HttpMethod", "List", "JsonSerializer",
                            "LogStream", "HttpServer", "RotatingLogPolicy", "StringBuilder",
                            "Console", "HttpRequestEventSource", "HttpWebSocket", "X509Certificate2",
                            "AppDomain", "Path", "Directory", "HttpServerConfiguration", "ListeningHost",
                            "ByteArrayContent", "ForwardingResolver", "IPAddress", "IPEndPoint",
                            "HttpServerExecutionResult", "ArgumentNullException", "JsonSerializerOptions",
                            "DbContext"
                        ];
                        const tokenValues = [
                            "RouteMethod", "Guid", "RequestHandlerExecutionMode", "HttpStatusCode",
                            "HttpStatusInformation", "DateTime", "TimeSpan", "RouterMethod",
                            "ListeningPort"
                        ];
                        const tokenInterfaces = [
                            "IRequestHandler", "IEnumerable", "ICollection", "IList"
                        ];
                        
                        function runStyles(node) {
                            if (node.nodeType === 3) {
                                applyStyles(node);
                                
                            } else if (node.nodeType === 1) {
                                
                                const prohibitedClasses = ["hljs-comment", "hljs-string"];
                                
                                if (! prohibitedClasses.some(cls => node.classList.contains(cls))) {
                                    for(const child of node.childNodes) {
                                        runStyles(child);
                                    }
                                }
                            }
                        }
                        
                        function applyStyles(textNode) {
                            const text = textNode.textContent;
                            const fragment = [];
                            
                            for (const token of splitText(text, [...tokenClasses, ...tokenValues, ...tokenInterfaces])) {
                                if (tokenClasses.includes(token)) {
                                    fragment.push(el("span.hljs-meta", token));
                                    
                                } else if (tokenValues.includes(token)) {
                                    fragment.push(el("span.hljs-meta-value", token));
                                    
                                } else if (tokenInterfaces.includes(token)) {
                                    fragment.push(el("span.hljs-meta-interface", token));
                                    
                                } else {
                                    fragment.push(token);
                                }
                            }
                            
                            textNode.replaceWith(el.fragment(...fragment));
                        }
                        
                        const code = pre.querySelector("code");
                        if (code && (code.classList.contains("lang-csharp") || code.classList.contains("lang-cs"))) {
                            runStyles(code);
                        }
                    }
                    
                    function addLineNumbers(pre) {
                        const code = pre.querySelector("code");
                        if (!code) return;
                        
                        var lines = (code.textContent.match(/\n/g) || []).length;
                        
                        if (lines <= 1) {
                            return;
                        }
                        
                        const lineElements = [];
                        for (let i = 1; i <= lines; i++) {
                            lineElements.push(el("span.hljs-line-number", i + "\n"));
                        }
                        
                        code.prepend(el("div.line-numbers", ...lineElements));
                        code.classList.add("has-line-numbers");
                    }
                                        
                    document.querySelectorAll("pre").forEach(pre => {
                        highlightMissingCodeTokens(pre);
                        addLineNumbers(pre);
                    });
                }
                
                runPostHljsFunctions();
            </script>
        </footer>
    </body>
</html>