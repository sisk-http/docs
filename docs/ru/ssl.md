# Работа с SSL

Работа с SSL для разработки может быть необходима при работе в контекстах, требующих безопасности, таких как большинство сценариев веб-разработки. Sisk работает поверх HttpListener, который не поддерживает родной HTTPS, только HTTP. Однако существуют обходные пути, которые позволяют работать с SSL в Sisk. См. их ниже:

## Через Sisk.Cadente.CoreEngine

- Доступно на: Linux, macOS, Windows
- Уровень сложности: легко

Возможно использовать экспериментальный **Cadente** движок в проектах Sisk, не требуя дополнительной настройки на компьютере или в проекте. Вам необходимо установить пакет `Sisk.Cadente.CoreEngine` в ваш проект, чтобы иметь возможность использовать сервер Cadente в сервере Sisk.

Чтобы настроить SSL, можно использовать методы `UseSsl` и `UseEngine` построителя:

```csharp
using var http = HttpServer.CreateBuilder()
    .UseEngine<CadenteHttpServerEngine>()
    .UseSsl(CertificateHelper.CreateTrustedDevelopmentCertificate("localhost"))
```

> Примечание: этот пакет仍 находится в экспериментальной фазе.

## Через IIS на Windows

- Доступно на: Windows
- Уровень сложности: средний

Если вы находитесь на Windows, вы можете использовать IIS для включения SSL на вашем HTTP-сервере. Для этого рекомендуется следовать [этому учебнику](/docs/ru/registering-namespace) заранее, если вы хотите, чтобы ваше приложение слушало на хосте, отличном от "localhost".

Для этого необходимо установить IIS через функции Windows. IIS доступен бесплатно для пользователей Windows и Windows Server. Чтобы настроить SSL в вашем приложении, необходимо иметь готовый SSL-сертификат, даже если он самоподписанный. Далее вы можете ознакомиться с [инструкцией по настройке SSL на IIS 7 или выше](https://learn.microsoft.com/en-us/iis/manage/configuring-security/how-to-set-up-ssl-on-iis).

## Через mitmproxy

- Доступно на: Linux, macOS, Windows
- Уровень сложности: легко

**mitmproxy** - это инструмент перехвата прокси, который позволяет разработчикам и тестировщикам безопасности осматривать, изменять и записывать HTTP- и HTTPS-трафик между клиентом (например, веб-браузером) и сервером. Вы можете использовать утилиту **mitmdump**, чтобы запустить обратный SSL-прокси между вашим клиентом и вашим приложением Sisk.

1. Сначала установите [mitmproxy](https://mitmproxy.org/) на вашем компьютере.
2. Запустите ваше приложение Sisk. В этом примере мы будем использовать порт 8000 в качестве не安全ного HTTP-порта.
3. Запустите сервер mitmproxy, чтобы он слушал на безопасном порту 8001:

```sh
mitmdump --mode reverse:http://localhost:8000/ -p 8001
```

И вы готовы! Вы уже можете получить доступ к вашему приложению через `https://localhost:8001/`. Вашему приложению не нужно запускаться, чтобы вы могли запустить `mitmdump`.

Альтернативно, вы можете добавить ссылку на [помощник mitmproxy](https://github.com/sisk-http/core/tree/main/extensions/Sisk.Helpers.mitmproxy) в ваш проект. Это все равно требует, чтобы mitmproxy был установлен на вашем компьютере.

## Через пакет Sisk.SslProxy

- Доступно на: Linux, macOS, Windows
- Уровень сложности: легко

> [!IMPORTANT]
>
> Пакет Sisk.SslProxy устарел в пользу пакета `Sisk.Cadente.CoreEngine` и больше не будет поддерживаться.

Пакет Sisk.SslProxy - это простой способ включить SSL на вашем приложении Sisk. Однако это **чрезвычайно экспериментальный** пакет. Работа с этим пакетом может быть нестабильной, но вы можете быть частью небольшого процента людей, которые будут вносить свой вклад в то, чтобы этот пакет стал жизнеспособным и стабильным. Чтобы начать, вы можете установить пакет Sisk.SslProxy с помощью:

```sh
dotnet add package Sisk.SslProxy
```

> [!NOTE]
>
> Вам необходимо включить "Включить предварительные выпуски" в диспетчере пакетов Visual Studio, чтобы установить Sisk.SslProxy.

Опять же, это экспериментальный проект, поэтому даже не думайте о его использовании в производстве.

На данный момент Sisk.SslProxy может обрабатывать большинство функций HTTP/1.1, включая HTTP Continue, Chunked-Encoding, WebSockets и SSE. Читайте больше о SslProxy [здесь](/docs/ru/extensions/ssl-proxy).