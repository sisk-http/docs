# Работа с SSL

Работа с SSL при разработке может быть необходима в контекстах, требующих безопасности, таких как большинство сценариев веб-разработки. Sisk работает поверх HttpListener, который не поддерживает нативный HTTPS, только HTTP. Однако существуют обходные пути, позволяющие работать с SSL в Sisk. См. их ниже:

## Через Sisk.Cadente.CoreEngine

- Доступно на: Linux, macOS, Windows
- Сложность: простая

Возможно использовать экспериментальный **Cadente** движок в проектах Sisk, без необходимости дополнительной настройки на компьютере или в проекте. Вам понадобится установить пакет `Sisk.Cadente.CoreEngine` в ваш проект, чтобы иметь возможность использовать сервер Cadente в сервере Sisk.

Для настройки SSL можно использовать методы `UseSsl` и `UseEngine` билдера:

```csharp
using var http = HttpServer.CreateBuilder()
    .UseEngine<CadenteHttpServerEngine>()
    .UseSsl(CertificateHelper.CreateTrustedDevelopmentCertificate("localhost"))
```

> Примечание: этот пакет всё ещё находится в экспериментальной фазе.

## Через IIS на Windows

- Доступно на: Windows
- Сложность: средняя

Если вы на Windows, вы можете использовать IIS для включения SSL на вашем HTTP-сервере. Для того чтобы это работало, желательно сначала пройти [этот учебник](/docs/ru/registering-namespace), если вы хотите, чтобы ваше приложение слушало хост, отличный от "localhost".

Для того чтобы это работало, вы должны установить IIS через функции Windows. IIS доступен бесплатно для пользователей Windows и Windows Server. Чтобы настроить SSL в вашем приложении, подготовьте сертификат SSL, даже если он самоподписанный. Далее вы можете посмотреть [как настроить SSL на IIS 7 или выше](https://learn.microsoft.com/en-us/iis/manage/configuring-security/how-to-set-up-ssl-on-iis).

## Через mitmproxy

- Доступно на: Linux, macOS, Windows
- Сложность: простая

**mitmproxy** — это инструмент прокси-интерцепции, который позволяет разработчикам и тестировщикам безопасности просматривать, изменять и записывать HTTP и HTTPS трафик между клиентом (например, веб-браузером) и сервером. Вы можете использовать утилиту **mitmdump** для запуска обратного SSL-прокси между вашим клиентом и приложением Sisk.

1. Сначала установите [mitmproxy](https://mitmproxy.org/) на вашу машину.
2. Запустите ваше приложение Sisk. Для этого примера мы будем использовать порт 8000 как небезопасный HTTP порт.
3. Запустите сервер mitmproxy, чтобы прослушивать безопасный порт на 8001:

```sh
mitmdump --mode reverse:http://localhost:8000/ -p 8001
```

И вы готовы! Вы уже можете получить доступ к вашему приложению через `https://localhost:8001/`. Ваше приложение не нужно быть запущенным, чтобы вы могли запустить `mitmdump`.

В качестве альтернативы вы можете добавить ссылку на [mitmproxy helper](https://github.com/sisk-http/core/tree/main/extensions/Sisk.Helpers.mitmproxy) в ваш проект. Это всё ещё требует, чтобы mitmproxy был установлен на вашем компьютере.

## Через пакет Sisk.SslProxy

- Доступно на: Linux, macOS, Windows
- Сложность: простая

> [!IMPORTANT]
>
> Пакет Sisk.SslProxy устарел в пользу пакета `Sisk.Cadente.CoreEngine` и больше не будет поддерживаться.

Пакет Sisk.SslProxy — это простой способ включить SSL в вашем приложении Sisk. Однако это **крайне экспериментальный** пакет. Он может быть нестабильным для работы с этим пакетом, но вы можете стать частью небольшого процента людей, которые будут способствовать тому, чтобы этот пакет стал жизнеспособным и стабильным. Чтобы начать, вы можете установить пакет Sisk.SslProxy с помощью:

```sh
dotnet add package Sisk.SslProxy
```

> [!NOTE]
>
> Вы должны включить «Include prerelease» в менеджере пакетов Visual Studio, чтобы установить Sisk.SslProxy.

Опять же, это экспериментальный проект, так что даже не думайте о том, чтобы использовать его в продакшене.

В настоящее время Sisk.SslProxy может обрабатывать большинство функций HTTP/1.1, включая HTTP Continue, Chunked-Encoding, WebSockets и SSE. Подробнее о SslProxy читайте [здесь](/docs/ru/extensions/ssl-proxy).